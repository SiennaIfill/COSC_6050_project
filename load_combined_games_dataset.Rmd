---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
library(lubridate)
library(datavolley)
library(tidyverse)

# Set working directory
# setwd(setwd("~/Documents/COSC 6510/final project/loading zone"))
setwd("~/Documents/COSC 6050/dvw files for final project")

# Establish team to scout
scout_team <- "marquette"
# List all .dvw files
# Save all their home games
home_pattern <- paste("at_",scout_team,"\\.dvw$",sep="")
home_pattern
home_files <- list.files(pattern = home_pattern)
#files <- list.files(pattern = "\\.dvw$")

# Read the first file and initialize the dataset
x <- read_dv(home_files[1], insert_technical_timeouts = FALSE)
home_game <- x$plays # Extract plays
home_game$date <- as_date(x$meta$match$date) # Add game date

# Loop through remaining files and combine their plays into `home_game`
for (i in 2:length(home_files)) {
  temp <- read_dv(home_files[i], insert_technical_timeouts = FALSE)
  hold <- temp$plays
  hold$date <- as_date(temp$meta$match$date)
  home_game <- rbind(home_game, hold)
}

# Construct a valid datavolley object
home_game_dvw <- read_dv(home_files[1], insert_technical_timeouts = FALSE) # Reload the first file as a template
home_game_dvw$plays <- home_game # Replace plays with the combined data
home_game_dvw$meta$match$date <- Sys.Date() # Update metadata date
home_game_dvw$meta$match$id <- paste(scout_team,"_Home_Games_Combined", sep="") # Assign an ID
home_game_dvw$meta$match$description <- "Combined home game data" # Optional description

# Write the combined data to a .dvw file
output_file <- paste(scout_team,"_Home_Games_Combined", sep="")
dv_write(home_game_dvw, file = output_file)

message("Practice data table has been exported as a .dvw file: ", output_file)

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

